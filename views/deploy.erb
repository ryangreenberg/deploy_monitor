<div class="row">
  <h2 class="span12"><%= @deploy.system.name %> Deploy <%= @deploy.id %></h2>

  <div class="span12">
    <% if @deploy.active %>
      <h2>
        <span class="status">
          In progress &middot;
          <span class="started-at">Started <%= format_hms("%M:%S", Time.now - @deploy.started_at) %> ago</span>
        </span>
      </h2>

      <% if @deploy.current_progress %>
        <h3 class="current-progress"><%= @deploy.current_progress.step.description %>&hellip;</h3>
      <% end %>

      <div class="deploy-progress progress progress-striped active">
        <div class="bar" style="width: <%= @deploy.progress_percentage %>%;"></div>
      </div>
    <% else %>
      <h3><%= @deploy.status_label.to_s.capitalize %> in <%= format_hms("(%?Hh) %Mm %Ss", @deploy.duration) %></h3>
      <div class="deploy-progress progress <%= @deploy.complete? ? 'progress-success' : 'progress-danger' %>">
        <div class="bar" style="width: 100%;"></div>
      </div>
    <% end %>
  </div>

  <table class="span12 table table-bordered">
    <thead>
      <tr>
        <th>Step</th>
        <th>Description</th>
        <th>Duration</th>
      </tr>
    </thead>

  <% @deploy.progresses.each do |progress| %>
    <tr class="<%= progress.active ? 'active' : '' %>">
      <td><%= progress.step.name %></td>
      <td><%= progress.step.description %></td>
      <td><%= format_hms("(%?Hh) %Mm %Ss", progress.duration) %></td>
    </tr>
  <% end %>
  <% @future_steps.each do |step| %>
  <tr>
    <td><%= step.name %></td>
    <td><%= step.description %></td>
    <td></td>
  </tr>
  <% end %>
  </table>

</div>